parameters:
- name: cloud
  brief: Cloud
  kind: user
  parameters:
  - name: kind
    value: aws
  - name: region
    fromEnv: AWS_REGION
- name: dns
  brief: DNS
  kind: user
  parameters:
  - name: name
    brief: DNS name
    fromEnv: HUB_STACK_NAME
  # - name: baseDomain
  #   brief: DNS base domain
  #   fromEnv: BASE_DOMAIN
  #   default: devops.delivery
  - name: domain
    fromEnv: HUB_DOMAIN_NAME
- name: component.storage-class.name
  value: default
- name: terraform.bucket
  brief: Terraform state location
  parameters:
  - name: name
    fromEnv: HUB_STATE_BUCKET
  - name: region
    fromEnv: HUB_STATE_REGION
- name: component.ingress
  parameters:
  - name: dashboard
    value: 'true'
  - name: ssoUrlPrefix
    value: apps
  - name: urlPrefix
    value: app
- name: component.istio
  parameters:
  - name: version.release
    value: 1.3.8
  - name: prometheus.enabled
    # this parameter is deprecated
    # it will be removed in the future
    value: "true"
- name: component.kubeflow
  parameters:
  - name: name
    value: kubeflow
  - name: namespace
    value: ${component.kubeflow.name}
  - name: passwd
    parameters:
    - name: 0.user
      value: admin@agilestacks.com
      env: HUB_DEX_USER
    - name: 0.password
      value: 12341234
  # - name: objectstore.endpoint
  #   value: ${component.bucket.endpoint.internal}
  # - name: objectstore.accessKey
  #   value: ${component.minio.accessKey}
  # - name: objectstore.secretKey
  #   value:  ${component.minio.secretKey}
  # - name: objectstore.region
  #   value: ${component.bucket.region}
  # - name: objectstore.bucket
  #   value: kubeflow
- name: component.minio
  kind: user
  parameters: 
  - name: accessKey
    value: minio
  - name: secretKey
    value: minio123
  - name: region
    # minio default region
    value: us-east-1

# consumed by kubeflow
- name: component.bucket.accessKey
  value: ${component.minio.accessKey}
- name: component.bucket.secretKey
  value: ${component.minio.secretKey}

- name: component.prometheus
  parameters: 
  - name: prometheus.volumeSize
    value: 12Gi
  - name: prometheus.retention
    value: 4h

- name: component.dex
  parameters: 
  - name: issuer
    value: https://auth.${dns.domain}
  - name: namespace
    value: kube-system
outputs:
- name: component.kubeflow.url
  brief: Kubeflow Central Dashboard
  value: hthtp://${component.kubeflow.name}.${dns.domain}/
- name: component.minio.url
  brief: Minio Endpoint
- name: component.istio.kiali.url
  brief: Istio Kiali
- name: component.prometheus.url
  brief: Prometheus Dashboard
- name: component.ingress.dashboard.url
  value: Traefik Dashboard

